var v="named",X="name",L="unmanaged",Z="optional",B="inject",N="multi_inject",nn="inversify:tagged",tn="inversify:tagged_props",k="inversify:paramtypes",ln="design:paramtypes",I="post_construct";function pn(){return[B,N,X,L,v,Z]}var H=pn(),p={Request:"Request",Singleton:"Singleton",Transient:"Transient"},l={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},m={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},gn=0;function M(){return gn++}var yn=function(){function t(n,e){this.id=M(),this.activated=!1,this.serviceIdentifier=n,this.scope=e,this.type=l.Invalid,this.constraint=function(r){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var n=new t(this.serviceIdentifier,this.scope);return n.activated=n.scope===p.Singleton?this.activated:!1,n.implementationType=this.implementationType,n.dynamicValue=this.dynamicValue,n.scope=this.scope,n.type=this.type,n.factory=this.factory,n.provider=this.provider,n.constraint=this.constraint,n.onActivation=this.onActivation,n.cache=this.cache,n},t}(),vn="Cannot apply @injectable decorator multiple times.",wn="Metadata key was used more than once in a parameter:",T="NULL argument",Y="Key Not Found",mn="Ambiguous match found for serviceIdentifier:",bn="Could not unbind serviceIdentifier:",_n="No matching bindings found for serviceIdentifier:",An="Missing required @injectable annotation in:",Tn="Missing required @inject or @multiInject annotation in:",Sn=function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},In="Circular dependency found:",Nn="Invalid binding type:",Cn="No snapshot available to restore.",En="Invalid return type in middleware. Middleware must return!",Mn="Value provided to function binding must be a function!",On="The toSelf function can only be applied when a constructor is used as service identifier",Rn="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",Dn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"The number of constructor arguments in the derived class "+(t[0]+" must be >= than the number of constructor arguments of its base class.")},Bn="Invalid Container constructor argument. Container options must be an object.",xn="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",Pn="Invalid Container option. Auto bind injectable must be a boolean",jn="Invalid Container option. Skip base check must be a boolean",Wn="Cannot apply @postConstruct decorator multiple times in the same class",kn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"@postConstruct error in class "+t[0]+": "+t[1]},Fn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"It looks like there is a circular dependency "+("in one of the '"+t[0]+"' bindings. Please investigate bindings with")+("service identifier '"+t[1]+"'.")},Vn="Maximum call stack size exceeded",Ln=function(){function t(){}return t.prototype.getConstructorMetadata=function(n){var e=Reflect.getMetadata(k,n),r=Reflect.getMetadata(nn,n);return{compilerGeneratedMetadata:e,userGeneratedMetadata:r||{}}},t.prototype.getPropertiesMetadata=function(n){var e=Reflect.getMetadata(tn,n)||[];return e},t}(),R={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function en(t){return t instanceof RangeError||t.message===Vn}function C(t){if(typeof t=="function"){var n=t;return n.name}else{if(typeof t=="symbol")return t.toString();var n=t;return n}}function J(t,n,e){var r="",i=e(t,n);return i.length!==0&&(r=`
Registered bindings:`,i.forEach(function(a){var u="Object";a.implementationType!==null&&(u=x(a.implementationType)),r=r+`
 `+u,a.constraint.metaData&&(r=r+" - "+a.constraint.metaData)})),r}function rn(t,n){return t.parentRequest===null?!1:t.parentRequest.serviceIdentifier===n?!0:rn(t.parentRequest,n)}function Gn(t){function n(r,i){i===void 0&&(i=[]);var a=C(r.serviceIdentifier);return i.push(a),r.parentRequest!==null?n(r.parentRequest,i):i}var e=n(t);return e.reverse().join(" --> ")}function an(t){t.childRequests.forEach(function(n){if(rn(n,n.serviceIdentifier)){var e=Gn(n);throw new Error(In+" "+e)}else an(n)})}function Un(t,n){if(n.isTagged()||n.isNamed()){var e="",r=n.getNamedTag(),i=n.getCustomTags();return r!==null&&(e+=r.toString()+`
`),i!==null&&i.forEach(function(a){e+=a.toString()+`
`})," "+t+`
 `+t+" - "+e}else return" "+t}function x(t){if(t.name)return t.name;var n=t.toString(),e=n.match(/^function\s*([^\s(]+)/);return e?e[1]:"Anonymous function: "+n}var on=function(){function t(n){this.id=M(),this.container=n}return t.prototype.addPlan=function(n){this.plan=n},t.prototype.setCurrentRequest=function(n){this.currentRequest=n},t}(),A=function(){function t(n,e){this.key=n,this.value=e}return t.prototype.toString=function(){return this.key===v?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},t}(),Kn=function(){function t(n,e){this.parentContext=n,this.rootRequest=e}return t}();function Hn(t,n,e,r){var i=nn;un(i,t,n,r,e)}function Yn(t,n,e){var r=tn;un(r,t.constructor,n,e)}function un(t,n,e,r,i){var a={},u=typeof i=="number",o=i!==void 0&&u?i.toString():e;if(u&&e!==void 0)throw new Error(Rn);Reflect.hasOwnMetadata(t,n)&&(a=Reflect.getMetadata(t,n));var c=a[o];if(!Array.isArray(c))c=[];else for(var s=0,h=c;s<h.length;s++){var f=h[s];if(f.key===r.key)throw new Error(wn+" "+f.key.toString())}c.push(r),a[o]=c,Reflect.defineMetadata(t,a,n)}function q(t,n){Reflect.decorate(t,n)}function Jn(t,n){return function(e,r){n(e,r,t)}}function gt(t,n,e){typeof e=="number"?q([Jn(e,t)],n):typeof e=="string"?Reflect.decorate([t],n,e):q([t],n)}var qn=function(){function t(n){this._cb=n}return t.prototype.unwrap=function(){return this._cb()},t}();function yt(t){return function(n,e,r){if(t===void 0)throw new Error(Sn(n.name));var i=new A(B,t);typeof r=="number"?Hn(n,e,r,i):Yn(n,e,i)}}var zn=function(){function t(n){this.str=n}return t.prototype.startsWith=function(n){return this.str.indexOf(n)===0},t.prototype.endsWith=function(n){var e="",r=n.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},r)},t.prototype.contains=function(n){return this.str.indexOf(n)!==-1},t.prototype.equals=function(n){return this.str===n},t.prototype.value=function(){return this.str},t}(),P=function(){function t(n,e,r,i){this.id=M(),this.type=n,this.serviceIdentifier=r,this.name=new zn(e||""),this.metadata=new Array;var a=null;typeof i=="string"?a=new A(v,i):i instanceof A&&(a=i),a!==null&&this.metadata.push(a)}return t.prototype.hasTag=function(n){for(var e=0,r=this.metadata;e<r.length;e++){var i=r[e];if(i.key===n)return!0}return!1},t.prototype.isArray=function(){return this.hasTag(N)},t.prototype.matchesArray=function(n){return this.matchesTag(N)(n)},t.prototype.isNamed=function(){return this.hasTag(v)},t.prototype.isTagged=function(){return this.metadata.some(function(n){return H.every(function(e){return n.key!==e})})},t.prototype.isOptional=function(){return this.matchesTag(Z)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(n){return n.key===v})[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(n){return H.every(function(e){return n.key!==e})}):null},t.prototype.matchesNamedTag=function(n){return this.matchesTag(v)(n)},t.prototype.matchesTag=function(n){var e=this;return function(r){for(var i=0,a=e.metadata;i<a.length;i++){var u=a[i];if(u.key===n&&u.value===r)return!0}return!1}},t}(),D=globalThis&&globalThis.__spreadArray||function(t,n){for(var e=0,r=n.length,i=t.length;e<r;e++,i++)t[i]=n[e];return t};function Qn(t,n){var e=x(n),r=sn(t,e,n,!1);return r}function sn(t,n,e,r){var i=t.getConstructorMetadata(e),a=i.compilerGeneratedMetadata;if(a===void 0){var u=An+" "+n+".";throw new Error(u)}var o=i.userGeneratedMetadata,c=Object.keys(o),s=e.length===0&&c.length>0,h=c.length>e.length,f=s||h?c.length:e.length,g=Xn(r,n,a,o,f),y=cn(t,e),b=D(D([],g),y);return b}function $n(t,n,e,r,i){var a=i[t.toString()]||[],u=fn(a),o=u.unmanaged!==!0,c=r[t],s=u.inject||u.multiInject;if(c=s||c,c instanceof qn&&(c=c.unwrap()),o){var h=c===Object,f=c===Function,g=c===void 0,y=h||f||g;if(!n&&y){var b=Tn+" argument "+t+" in class "+e+".";throw new Error(b)}var K=new P(m.ConstructorArgument,u.targetName,c);return K.metadata=a,K}return null}function Xn(t,n,e,r,i){for(var a=[],u=0;u<i;u++){var o=u,c=$n(o,t,n,e,r);c!==null&&a.push(c)}return a}function cn(t,n){for(var e=t.getPropertiesMetadata(n),r=[],i=Object.keys(e),a=0,u=i;a<u.length;a++){var o=u[a],c=e[o],s=fn(e[o]),h=s.targetName||o,f=s.inject||s.multiInject,g=new P(m.ClassProperty,h,f);g.metadata=c,r.push(g)}var y=Object.getPrototypeOf(n.prototype).constructor;if(y!==Object){var b=cn(t,y);r=D(D([],r),b)}return r}function hn(t,n){var e=Object.getPrototypeOf(n.prototype).constructor;if(e!==Object){var r=x(e),i=sn(t,r,e,!0),a=i.map(function(c){return c.metadata.filter(function(s){return s.key===L})}),u=[].concat.apply([],a).length,o=i.length-u;return o>0?o:hn(t,e)}else return 0}function fn(t){var n={};return t.forEach(function(e){n[e.key.toString()]=e.value}),{inject:n[B],multiInject:n[N],targetName:n[X],unmanaged:n[L]}}var G=function(){function t(n,e,r,i,a){this.id=M(),this.serviceIdentifier=n,this.parentContext=e,this.parentRequest=r,this.target=a,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=r===null?new Map:null}return t.prototype.addChildRequest=function(n,e,r){var i=new t(n,this.parentContext,this,e,r);return this.childRequests.push(i),i},t}();function F(t){return t._bindingDictionary}function Zn(t,n,e,r,i,a){var u=t?N:B,o=new A(u,e),c=new P(n,r,e,o);if(i!==void 0){var s=new A(i,a);c.metadata.push(s)}return c}function z(t,n,e,r,i){var a=E(e.container,i.serviceIdentifier),u=[];return a.length===R.NoBindingsAvailable&&e.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&t.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(e.container.bind(i.serviceIdentifier).toSelf(),a=E(e.container,i.serviceIdentifier)),n?u=a:u=a.filter(function(o){var c=new G(o.serviceIdentifier,e,r,o,i);return o.constraint(c)}),nt(i.serviceIdentifier,u,i,e.container),u}function nt(t,n,e,r){switch(n.length){case R.NoBindingsAvailable:if(e.isOptional())return n;var i=C(t),a=_n;throw a+=Un(i,e),a+=J(r,i,E),new Error(a);case R.OnlyOneBindingAvailable:if(!e.isArray())return n;case R.MultipleBindingsAvailable:default:if(e.isArray())return n;var i=C(t),a=mn+" "+i;throw a+=J(r,i,E),new Error(a)}}function dn(t,n,e,r,i,a){var u,o;if(i===null){u=z(t,n,r,null,a),o=new G(e,r,null,u,a);var c=new Kn(r,o);r.addPlan(c)}else u=z(t,n,r,i,a),o=i.addChildRequest(a.serviceIdentifier,u,a);u.forEach(function(s){var h=null;if(a.isArray())h=o.addChildRequest(s.serviceIdentifier,s,a);else{if(s.cache)return;h=o}if(s.type===l.Instance&&s.implementationType!==null){var f=Qn(t,s.implementationType);if(!r.container.options.skipBaseClassChecks){var g=hn(t,s.implementationType);if(f.length<g){var y=Dn(x(s.implementationType));throw new Error(y)}}f.forEach(function(b){dn(t,!1,b.serviceIdentifier,r,h,b)})}})}function E(t,n){var e=[],r=F(t);return r.hasKey(n)?e=r.get(n):t.parent!==null&&(e=E(t.parent,n)),e}function tt(t,n,e,r,i,a,u,o){o===void 0&&(o=!1);var c=new on(n),s=Zn(e,r,i,"",a,u);try{return dn(t,o,i,c,null,s),c}catch(h){throw en(h)&&c.plan&&an(c.plan.rootRequest),h}}function et(t,n,e,r){var i=new P(m.Variable,"",n,new A(e,r)),a=new on(t),u=new G(n,a,null,[],i);return u}var rt=globalThis&&globalThis.__spreadArray||function(t,n){for(var e=0,r=n.length,i=t.length;e<r;e++,i++)t[i]=n[e];return t};function it(t,n,e){var r=n.filter(function(a){return a.target!==null&&a.target.type===m.ClassProperty}),i=r.map(e);return r.forEach(function(a,u){var o="";o=a.target.name.value();var c=i[u];t[o]=c}),t}function at(t,n){return new(t.bind.apply(t,rt([void 0],n)))}function ot(t,n){if(Reflect.hasMetadata(I,t)){var e=Reflect.getMetadata(I,t);try{n[e.value]()}catch(r){throw new Error(kn(t.name,r.message))}}}function ut(t,n,e){var r=null;if(n.length>0){var i=n.filter(function(u){return u.target!==null&&u.target.type===m.ConstructorArgument}),a=i.map(e);r=at(t,a),r=it(r,n,e)}else r=new t;return ot(t,r),r}var j=function(t,n,e){try{return e()}catch(r){throw en(r)?new Error(Fn(t,n.toString())):r}},V=function(t){return function(n){n.parentContext.setCurrentRequest(n);var e=n.bindings,r=n.childRequests,i=n.target&&n.target.isArray(),a=!n.parentRequest||!n.parentRequest.target||!n.target||!n.parentRequest.target.matchesArray(n.target.serviceIdentifier);if(i&&a)return r.map(function(f){var g=V(t);return g(f)});var u=null;if(n.target.isOptional()&&e.length===0)return;var o=e[0],c=o.scope===p.Singleton,s=o.scope===p.Request;if(c&&o.activated)return o.cache;if(s&&t!==null&&t.has(o.id))return t.get(o.id);if(o.type===l.ConstantValue)u=o.cache,o.activated=!0;else if(o.type===l.Function)u=o.cache,o.activated=!0;else if(o.type===l.Constructor)u=o.implementationType;else if(o.type===l.DynamicValue&&o.dynamicValue!==null)u=j("toDynamicValue",o.serviceIdentifier,function(){return o.dynamicValue(n.parentContext)});else if(o.type===l.Factory&&o.factory!==null)u=j("toFactory",o.serviceIdentifier,function(){return o.factory(n.parentContext)});else if(o.type===l.Provider&&o.provider!==null)u=j("toProvider",o.serviceIdentifier,function(){return o.provider(n.parentContext)});else if(o.type===l.Instance&&o.implementationType!==null)u=ut(o.implementationType,r,V(t));else{var h=C(n.serviceIdentifier);throw new Error(Nn+" "+h)}return typeof o.onActivation=="function"&&(u=o.onActivation(n.parentContext,u)),c&&(o.cache=u,o.activated=!0),s&&t!==null&&!t.has(o.id)&&t.set(o.id,u),u}};function st(t){var n=V(t.plan.rootRequest.requestScope);return n(t.plan.rootRequest)}var w=function(t,n){var e=t.parentRequest;return e!==null?n(e)?!0:w(e,n):!1},S=function(t){return function(n){var e=function(r){return r!==null&&r.target!==null&&r.target.matchesTag(t)(n)};return e.metaData=new A(t,n),e}},O=S(v),W=function(t){return function(n){var e=null;if(n!==null)if(e=n.bindings[0],typeof t=="string"){var r=e.serviceIdentifier;return r===t}else{var i=n.bindings[0].implementationType;return t===i}return!1}},U=function(){function t(n){this._binding=n}return t.prototype.when=function(n){return this._binding.constraint=n,new d(this._binding)},t.prototype.whenTargetNamed=function(n){return this._binding.constraint=O(n),new d(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(n){var e=n.target!==null&&!n.target.isNamed()&&!n.target.isTagged();return e},new d(this._binding)},t.prototype.whenTargetTagged=function(n,e){return this._binding.constraint=S(n)(e),new d(this._binding)},t.prototype.whenInjectedInto=function(n){return this._binding.constraint=function(e){return W(n)(e.parentRequest)},new d(this._binding)},t.prototype.whenParentNamed=function(n){return this._binding.constraint=function(e){return O(n)(e.parentRequest)},new d(this._binding)},t.prototype.whenParentTagged=function(n,e){return this._binding.constraint=function(r){return S(n)(e)(r.parentRequest)},new d(this._binding)},t.prototype.whenAnyAncestorIs=function(n){return this._binding.constraint=function(e){return w(e,W(n))},new d(this._binding)},t.prototype.whenNoAncestorIs=function(n){return this._binding.constraint=function(e){return!w(e,W(n))},new d(this._binding)},t.prototype.whenAnyAncestorNamed=function(n){return this._binding.constraint=function(e){return w(e,O(n))},new d(this._binding)},t.prototype.whenNoAncestorNamed=function(n){return this._binding.constraint=function(e){return!w(e,O(n))},new d(this._binding)},t.prototype.whenAnyAncestorTagged=function(n,e){return this._binding.constraint=function(r){return w(r,S(n)(e))},new d(this._binding)},t.prototype.whenNoAncestorTagged=function(n,e){return this._binding.constraint=function(r){return!w(r,S(n)(e))},new d(this._binding)},t.prototype.whenAnyAncestorMatches=function(n){return this._binding.constraint=function(e){return w(e,n)},new d(this._binding)},t.prototype.whenNoAncestorMatches=function(n){return this._binding.constraint=function(e){return!w(e,n)},new d(this._binding)},t}(),d=function(){function t(n){this._binding=n}return t.prototype.onActivation=function(n){return this._binding.onActivation=n,new U(this._binding)},t}(),_=function(){function t(n){this._binding=n,this._bindingWhenSyntax=new U(this._binding),this._bindingOnSyntax=new d(this._binding)}return t.prototype.when=function(n){return this._bindingWhenSyntax.when(n)},t.prototype.whenTargetNamed=function(n){return this._bindingWhenSyntax.whenTargetNamed(n)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(n,e){return this._bindingWhenSyntax.whenTargetTagged(n,e)},t.prototype.whenInjectedInto=function(n){return this._bindingWhenSyntax.whenInjectedInto(n)},t.prototype.whenParentNamed=function(n){return this._bindingWhenSyntax.whenParentNamed(n)},t.prototype.whenParentTagged=function(n,e){return this._bindingWhenSyntax.whenParentTagged(n,e)},t.prototype.whenAnyAncestorIs=function(n){return this._bindingWhenSyntax.whenAnyAncestorIs(n)},t.prototype.whenNoAncestorIs=function(n){return this._bindingWhenSyntax.whenNoAncestorIs(n)},t.prototype.whenAnyAncestorNamed=function(n){return this._bindingWhenSyntax.whenAnyAncestorNamed(n)},t.prototype.whenAnyAncestorTagged=function(n,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(n,e)},t.prototype.whenNoAncestorNamed=function(n){return this._bindingWhenSyntax.whenNoAncestorNamed(n)},t.prototype.whenNoAncestorTagged=function(n,e){return this._bindingWhenSyntax.whenNoAncestorTagged(n,e)},t.prototype.whenAnyAncestorMatches=function(n){return this._bindingWhenSyntax.whenAnyAncestorMatches(n)},t.prototype.whenNoAncestorMatches=function(n){return this._bindingWhenSyntax.whenNoAncestorMatches(n)},t.prototype.onActivation=function(n){return this._bindingOnSyntax.onActivation(n)},t}(),ct=function(){function t(n){this._binding=n}return t.prototype.inRequestScope=function(){return this._binding.scope=p.Request,new _(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=p.Singleton,new _(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=p.Transient,new _(this._binding)},t}(),Q=function(){function t(n){this._binding=n,this._bindingWhenSyntax=new U(this._binding),this._bindingOnSyntax=new d(this._binding),this._bindingInSyntax=new ct(n)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(n){return this._bindingWhenSyntax.when(n)},t.prototype.whenTargetNamed=function(n){return this._bindingWhenSyntax.whenTargetNamed(n)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(n,e){return this._bindingWhenSyntax.whenTargetTagged(n,e)},t.prototype.whenInjectedInto=function(n){return this._bindingWhenSyntax.whenInjectedInto(n)},t.prototype.whenParentNamed=function(n){return this._bindingWhenSyntax.whenParentNamed(n)},t.prototype.whenParentTagged=function(n,e){return this._bindingWhenSyntax.whenParentTagged(n,e)},t.prototype.whenAnyAncestorIs=function(n){return this._bindingWhenSyntax.whenAnyAncestorIs(n)},t.prototype.whenNoAncestorIs=function(n){return this._bindingWhenSyntax.whenNoAncestorIs(n)},t.prototype.whenAnyAncestorNamed=function(n){return this._bindingWhenSyntax.whenAnyAncestorNamed(n)},t.prototype.whenAnyAncestorTagged=function(n,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(n,e)},t.prototype.whenNoAncestorNamed=function(n){return this._bindingWhenSyntax.whenNoAncestorNamed(n)},t.prototype.whenNoAncestorTagged=function(n,e){return this._bindingWhenSyntax.whenNoAncestorTagged(n,e)},t.prototype.whenAnyAncestorMatches=function(n){return this._bindingWhenSyntax.whenAnyAncestorMatches(n)},t.prototype.whenNoAncestorMatches=function(n){return this._bindingWhenSyntax.whenNoAncestorMatches(n)},t.prototype.onActivation=function(n){return this._bindingOnSyntax.onActivation(n)},t}(),ht=function(){function t(n){this._binding=n}return t.prototype.to=function(n){return this._binding.type=l.Instance,this._binding.implementationType=n,new Q(this._binding)},t.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+On);var n=this._binding.serviceIdentifier;return this.to(n)},t.prototype.toConstantValue=function(n){return this._binding.type=l.ConstantValue,this._binding.cache=n,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=p.Singleton,new _(this._binding)},t.prototype.toDynamicValue=function(n){return this._binding.type=l.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=n,this._binding.implementationType=null,new Q(this._binding)},t.prototype.toConstructor=function(n){return this._binding.type=l.Constructor,this._binding.implementationType=n,this._binding.scope=p.Singleton,new _(this._binding)},t.prototype.toFactory=function(n){return this._binding.type=l.Factory,this._binding.factory=n,this._binding.scope=p.Singleton,new _(this._binding)},t.prototype.toFunction=function(n){if(typeof n!="function")throw new Error(Mn);var e=this.toConstantValue(n);return this._binding.type=l.Function,this._binding.scope=p.Singleton,e},t.prototype.toAutoFactory=function(n){return this._binding.type=l.Factory,this._binding.factory=function(e){var r=function(){return e.container.get(n)};return r},this._binding.scope=p.Singleton,new _(this._binding)},t.prototype.toProvider=function(n){return this._binding.type=l.Provider,this._binding.provider=n,this._binding.scope=p.Singleton,new _(this._binding)},t.prototype.toService=function(n){this.toDynamicValue(function(e){return e.container.get(n)})},t}(),ft=function(){function t(){}return t.of=function(n,e){var r=new t;return r.bindings=n,r.middleware=e,r},t}(),$=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(n,e){if(n==null)throw new Error(T);if(e==null)throw new Error(T);var r=this._map.get(n);r!==void 0?(r.push(e),this._map.set(n,r)):this._map.set(n,[e])},t.prototype.get=function(n){if(n==null)throw new Error(T);var e=this._map.get(n);if(e!==void 0)return e;throw new Error(Y)},t.prototype.remove=function(n){if(n==null)throw new Error(T);if(!this._map.delete(n))throw new Error(Y)},t.prototype.removeByCondition=function(n){var e=this;this._map.forEach(function(r,i){var a=r.filter(function(u){return!n(u)});a.length>0?e._map.set(i,a):e._map.delete(i)})},t.prototype.hasKey=function(n){if(n==null)throw new Error(T);return this._map.has(n)},t.prototype.clone=function(){var n=new t;return this._map.forEach(function(e,r){e.forEach(function(i){return n.add(r,i.clone())})}),n},t.prototype.traverse=function(n){this._map.forEach(function(e,r){n(r,e)})},t}(),dt=globalThis&&globalThis.__awaiter||function(t,n,e,r){function i(a){return a instanceof e?a:new e(function(u){u(a)})}return new(e||(e=Promise))(function(a,u){function o(h){try{s(r.next(h))}catch(f){u(f)}}function c(h){try{s(r.throw(h))}catch(f){u(f)}}function s(h){h.done?a(h.value):i(h.value).then(o,c)}s((r=r.apply(t,n||[])).next())})},lt=globalThis&&globalThis.__generator||function(t,n){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,u;return u={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function o(s){return function(h){return c([s,h])}}function c(s){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){e.label=s[1];break}if(s[0]===6&&e.label<a[1]){e.label=a[1],a=s;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(s);break}a[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(t,e)}catch(h){s=[6,h],i=0}finally{r=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},pt=globalThis&&globalThis.__spreadArray||function(t,n){for(var e=0,r=n.length,i=t.length;e<r;e++,i++)t[i]=n[e];return t},vt=function(){function t(n){this._appliedMiddleware=[];var e=n||{};if(typeof e!="object")throw new Error(""+Bn);if(e.defaultScope===void 0)e.defaultScope=p.Transient;else if(e.defaultScope!==p.Singleton&&e.defaultScope!==p.Transient&&e.defaultScope!==p.Request)throw new Error(""+xn);if(e.autoBindInjectable===void 0)e.autoBindInjectable=!1;else if(typeof e.autoBindInjectable!="boolean")throw new Error(""+Pn);if(e.skipBaseClassChecks===void 0)e.skipBaseClassChecks=!1;else if(typeof e.skipBaseClassChecks!="boolean")throw new Error(""+jn);this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.id=M(),this._bindingDictionary=new $,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new Ln}return t.merge=function(n,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var a=new t,u=pt([n,e],r).map(function(s){return F(s)}),o=F(a);function c(s,h){s.traverse(function(f,g){g.forEach(function(y){h.add(y.serviceIdentifier,y.clone())})})}return u.forEach(function(s){c(s,o)}),a},t.prototype.load=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var r=this._getContainerModuleHelpersFactory(),i=0,a=n;i<a.length;i++){var u=a[i],o=r(u.id);u.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)}},t.prototype.loadAsync=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return dt(this,void 0,void 0,function(){var r,i,a,u,o;return lt(this,function(c){switch(c.label){case 0:r=this._getContainerModuleHelpersFactory(),i=0,a=n,c.label=1;case 1:return i<a.length?(u=a[i],o=r(u.id),[4,u.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)]):[3,4];case 2:c.sent(),c.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},t.prototype.unload=function(){for(var n=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=function(a){return function(u){return u.moduleId===a}};e.forEach(function(a){var u=i(a.id);n._bindingDictionary.removeByCondition(u)})},t.prototype.bind=function(n){var e=this.options.defaultScope||p.Transient,r=new yn(n,e);return this._bindingDictionary.add(n,r),new ht(r)},t.prototype.rebind=function(n){return this.unbind(n),this.bind(n)},t.prototype.unbind=function(n){try{this._bindingDictionary.remove(n)}catch{throw new Error(bn+" "+C(n))}},t.prototype.unbindAll=function(){this._bindingDictionary=new $},t.prototype.isBound=function(n){var e=this._bindingDictionary.hasKey(n);return!e&&this.parent&&(e=this.parent.isBound(n)),e},t.prototype.isBoundNamed=function(n,e){return this.isBoundTagged(n,v,e)},t.prototype.isBoundTagged=function(n,e,r){var i=!1;if(this._bindingDictionary.hasKey(n)){var a=this._bindingDictionary.get(n),u=et(this,n,e,r);i=a.some(function(o){return o.constraint(u)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(n,e,r)),i},t.prototype.snapshot=function(){this._snapshots.push(ft.of(this._bindingDictionary.clone(),this._middleware))},t.prototype.restore=function(){var n=this._snapshots.pop();if(n===void 0)throw new Error(Cn);this._bindingDictionary=n.bindings,this._middleware=n.middleware},t.prototype.createChild=function(n){var e=new t(n||this.options);return e.parent=this,e},t.prototype.applyMiddleware=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];this._appliedMiddleware=this._appliedMiddleware.concat(n);var r=this._middleware?this._middleware:this._planAndResolve();this._middleware=n.reduce(function(i,a){return a(i)},r)},t.prototype.applyCustomMetadataReader=function(n){this._metadataReader=n},t.prototype.get=function(n){return this._get(!1,!1,m.Variable,n)},t.prototype.getTagged=function(n,e,r){return this._get(!1,!1,m.Variable,n,e,r)},t.prototype.getNamed=function(n,e){return this.getTagged(n,v,e)},t.prototype.getAll=function(n){return this._get(!0,!0,m.Variable,n)},t.prototype.getAllTagged=function(n,e,r){return this._get(!1,!0,m.Variable,n,e,r)},t.prototype.getAllNamed=function(n,e){return this.getAllTagged(n,v,e)},t.prototype.resolve=function(n){var e=this.createChild();return e.bind(n).toSelf(),this._appliedMiddleware.forEach(function(r){e.applyMiddleware(r)}),e.get(n)},t.prototype._getContainerModuleHelpersFactory=function(){var n=this,e=function(o,c){o._binding.moduleId=c},r=function(o){return function(c){var s=n.bind.bind(n),h=s(c);return e(h,o),h}},i=function(o){return function(c){var s=n.unbind.bind(n);s(c)}},a=function(o){return function(c){var s=n.isBound.bind(n);return s(c)}},u=function(o){return function(c){var s=n.rebind.bind(n),h=s(c);return e(h,o),h}};return function(o){return{bindFunction:r(o),isboundFunction:a(),rebindFunction:u(o),unbindFunction:i()}}},t.prototype._get=function(n,e,r,i,a,u){var o=null,c={avoidConstraints:n,contextInterceptor:function(s){return s},isMultiInject:e,key:a,serviceIdentifier:i,targetType:r,value:u};if(this._middleware){if(o=this._middleware(c),o==null)throw new Error(En)}else o=this._planAndResolve()(c);return o},t.prototype._planAndResolve=function(){var n=this;return function(e){var r=tt(n._metadataReader,n,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);r=e.contextInterceptor(r);var i=st(r);return i}},t}();function wt(){return function(t){if(Reflect.hasOwnMetadata(k,t))throw new Error(vn);var n=Reflect.getMetadata(ln,t)||[];return Reflect.defineMetadata(k,n,t),t}}function mt(){return function(t,n,e){var r=new A(I,n);if(Reflect.hasOwnMetadata(I,t.constructor))throw new Error(Wn);Reflect.defineMetadata(I,r,t.constructor)}}export{vt as C,yt as a,gt as d,wt as i,mt as p};
