function fn(n,e){return n.parent===e.parent?1:2}function cn(n){return n.reduce(hn,0)/n.length}function hn(n,e){return n+e.x}function ln(n){return 1+n.reduce(sn,0)}function sn(n,e){return Math.max(n,e.y)}function on(n){for(var e;e=n.children;)n=e[0];return n}function dn(n){for(var e;e=n.children;)n=e[e.length-1];return n}function pn(){var n=fn,e=1,t=1,r=!1;function i(u){var c,h=0;u.eachAfter(function(a){var d=a.children;d?(a.x=cn(d),a.y=ln(d)):(a.x=c?h+=n(a,c):0,a.y=0,c=a)});var l=on(u),f=dn(u),s=l.x-n(l,f)/2,o=f.x+n(f,l)/2;return u.eachAfter(r?function(a){a.x=(a.x-u.x)*e,a.y=(u.y-a.y)*t}:function(a){a.x=(a.x-s)/(o-s)*e,a.y=(1-(u.y?a.y/u.y:1))*t})}return i.separation=function(u){return arguments.length?(n=u,i):n},i.size=function(u){return arguments.length?(r=!1,e=+u[0],t=+u[1],i):r?null:[e,t]},i.nodeSize=function(u){return arguments.length?(r=!0,e=+u[0],t=+u[1],i):r?[e,t]:null},i}function gn(n){var e=0,t=n.children,r=t&&t.length;if(!r)e=1;else for(;--r>=0;)e+=t[r].value;n.value=e}function yn(){return this.eachAfter(gn)}function xn(n,e){let t=-1;for(const r of this)n.call(e,r,++t,this);return this}function mn(n,e){for(var t=this,r=[t],i,u,c=-1;t=r.pop();)if(n.call(e,t,++c,this),i=t.children)for(u=i.length-1;u>=0;--u)r.push(i[u]);return this}function vn(n,e){for(var t=this,r=[t],i=[],u,c,h,l=-1;t=r.pop();)if(i.push(t),u=t.children)for(c=0,h=u.length;c<h;++c)r.push(u[c]);for(;t=i.pop();)n.call(e,t,++l,this);return this}function _n(n,e){let t=-1;for(const r of this)if(n.call(e,r,++t,this))return r}function wn(n){return this.eachAfter(function(e){for(var t=+n(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)t+=r[i].value;e.value=t})}function zn(n){return this.eachBefore(function(e){e.children&&e.children.sort(n)})}function An(n){for(var e=this,t=Mn(e,n),r=[e];e!==t;)e=e.parent,r.push(e);for(var i=r.length;n!==t;)r.splice(i,0,n),n=n.parent;return r}function Mn(n,e){if(n===e)return n;var t=n.ancestors(),r=e.ancestors(),i=null;for(n=t.pop(),e=r.pop();n===e;)i=n,n=t.pop(),e=r.pop();return i}function kn(){for(var n=this,e=[n];n=n.parent;)e.push(n);return e}function qn(){return Array.from(this)}function Sn(){var n=[];return this.eachBefore(function(e){e.children||n.push(e)}),n}function Rn(){var n=this,e=[];return n.each(function(t){t!==n&&e.push({source:t.parent,target:t})}),e}function*Nn(){var n=this,e,t=[n],r,i,u;do for(e=t.reverse(),t=[];n=e.pop();)if(yield n,r=n.children)for(i=0,u=r.length;i<u;++i)t.push(r[i]);while(t.length)}function H(n,e){n instanceof Map?(n=[void 0,n],e===void 0&&(e=Bn)):e===void 0&&(e=En);for(var t=new I(n),r,i=[t],u,c,h,l;r=i.pop();)if((c=e(r.data))&&(l=(c=Array.from(c)).length))for(r.children=c,h=l-1;h>=0;--h)i.push(u=c[h]=new I(c[h])),u.parent=r,u.depth=r.depth+1;return t.eachBefore(J)}function In(){return H(this).eachBefore(Ln)}function En(n){return n.children}function Bn(n){return Array.isArray(n)?n[1]:null}function Ln(n){n.data.value!==void 0&&(n.value=n.data.value),n.data=n.data.data}function J(n){var e=0;do n.height=e;while((n=n.parent)&&n.height<++e)}function I(n){this.data=n,this.depth=this.height=0,this.parent=null}I.prototype=H.prototype={constructor:I,count:yn,each:xn,eachAfter:vn,eachBefore:mn,find:_n,sum:wn,sort:zn,path:An,ancestors:kn,descendants:qn,leaves:Sn,links:Rn,copy:In,[Symbol.iterator]:Nn};function Tn(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Cn(n){for(var e=n.length,t,r;e;)r=Math.random()*e--|0,t=n[e],n[e]=n[r],n[r]=t;return n}function Q(n){for(var e=0,t=(n=Cn(Array.from(n))).length,r=[],i,u;e<t;)i=n[e],u&&U(u,i)?++e:(u=bn(r=On(r,i)),e=0);return u}function On(n,e){var t,r;if(D(e,n))return[e];for(t=0;t<n.length;++t)if(L(e,n[t])&&D(E(n[t],e),n))return[n[t],e];for(t=0;t<n.length-1;++t)for(r=t+1;r<n.length;++r)if(L(E(n[t],n[r]),e)&&L(E(n[t],e),n[r])&&L(E(n[r],e),n[t])&&D(nn(n[t],n[r],e),n))return[n[t],n[r],e];throw new Error}function L(n,e){var t=n.r-e.r,r=e.x-n.x,i=e.y-n.y;return t<0||t*t<r*r+i*i}function U(n,e){var t=n.r-e.r+Math.max(n.r,e.r,1)*1e-9,r=e.x-n.x,i=e.y-n.y;return t>0&&t*t>r*r+i*i}function D(n,e){for(var t=0;t<e.length;++t)if(!U(n,e[t]))return!1;return!0}function bn(n){switch(n.length){case 1:return jn(n[0]);case 2:return E(n[0],n[1]);case 3:return nn(n[0],n[1],n[2])}}function jn(n){return{x:n.x,y:n.y,r:n.r}}function E(n,e){var t=n.x,r=n.y,i=n.r,u=e.x,c=e.y,h=e.r,l=u-t,f=c-r,s=h-i,o=Math.sqrt(l*l+f*f);return{x:(t+u+l/o*s)/2,y:(r+c+f/o*s)/2,r:(o+i+h)/2}}function nn(n,e,t){var r=n.x,i=n.y,u=n.r,c=e.x,h=e.y,l=e.r,f=t.x,s=t.y,o=t.r,a=r-c,d=r-f,p=i-h,g=i-s,y=l-u,x=o-u,m=r*r+i*i-u*u,z=m-c*c-h*h+l*l,_=m-f*f-s*s+o*o,v=d*p-a*g,w=(p*_-g*z)/(v*2)-r,k=(g*y-p*x)/v,A=(d*z-a*_)/(v*2)-i,M=(a*x-d*y)/v,R=k*k+M*M-1,q=2*(u+w*k+A*M),K=w*w+A*A-u*u,j=-(R?(q+Math.sqrt(q*q-4*R*K))/(2*R):K/q);return{x:r+w+k*j,y:i+A+M*j,r:j}}function P(n,e,t){var r=n.x-e.x,i,u,c=n.y-e.y,h,l,f=r*r+c*c;f?(u=e.r+t.r,u*=u,l=n.r+t.r,l*=l,u>l?(i=(f+l-u)/(2*f),h=Math.sqrt(Math.max(0,l/f-i*i)),t.x=n.x-i*r-h*c,t.y=n.y-i*c+h*r):(i=(f+u-l)/(2*f),h=Math.sqrt(Math.max(0,u/f-i*i)),t.x=e.x+i*r-h*c,t.y=e.y+i*c+h*r)):(t.x=e.x+t.r,t.y=e.y)}function X(n,e){var t=n.r+e.r-1e-6,r=e.x-n.x,i=e.y-n.y;return t>0&&t*t>r*r+i*i}function Y(n){var e=n._,t=n.next._,r=e.r+t.r,i=(e.x*t.r+t.x*e.r)/r,u=(e.y*t.r+t.y*e.r)/r;return i*i+u*u}function T(n){this._=n,this.next=null,this.previous=null}function en(n){if(!(i=(n=Tn(n)).length))return 0;var e,t,r,i,u,c,h,l,f,s,o;if(e=n[0],e.x=0,e.y=0,!(i>1))return e.r;if(t=n[1],e.x=-t.r,t.x=e.r,t.y=0,!(i>2))return e.r+t.r;P(t,e,r=n[2]),e=new T(e),t=new T(t),r=new T(r),e.next=r.previous=t,t.next=e.previous=r,r.next=t.previous=e;n:for(h=3;h<i;++h){P(e._,t._,r=n[h]),r=new T(r),l=t.next,f=e.previous,s=t._.r,o=e._.r;do if(s<=o){if(X(l._,r._)){t=l,e.next=t,t.previous=e,--h;continue n}s+=l._.r,l=l.next}else{if(X(f._,r._)){e=f,e.next=t,t.previous=e,--h;continue n}o+=f._.r,f=f.previous}while(l!==f.next);for(r.previous=e,r.next=t,e.next=t.previous=t=r,u=Y(e);(r=r.next)!==t;)(c=Y(r))<u&&(e=r,u=c);t=e.next}for(e=[t._],r=t;(r=r.next)!==t;)e.push(r._);for(r=Q(e),h=0;h<i;++h)e=n[h],e.x-=r.x,e.y-=r.y;return r.r}function Dn(n){return en(n),n}function Vn(n){return n==null?null:O(n)}function O(n){if(typeof n!="function")throw new Error;return n}function S(){return 0}function N(n){return function(){return n}}function Wn(n){return Math.sqrt(n.value)}function $n(){var n=null,e=1,t=1,r=S;function i(u){return u.x=e/2,u.y=t/2,n?u.eachBefore(Z(n)).eachAfter(V(r,.5)).eachBefore(F(1)):u.eachBefore(Z(Wn)).eachAfter(V(S,1)).eachAfter(V(r,u.r/Math.min(e,t))).eachBefore(F(Math.min(e,t)/(2*u.r))),u}return i.radius=function(u){return arguments.length?(n=Vn(u),i):n},i.size=function(u){return arguments.length?(e=+u[0],t=+u[1],i):[e,t]},i.padding=function(u){return arguments.length?(r=typeof u=="function"?u:N(+u),i):r},i}function Z(n){return function(e){e.children||(e.r=Math.max(0,+n(e)||0))}}function V(n,e){return function(t){if(r=t.children){var r,i,u=r.length,c=n(t)*e||0,h;if(c)for(i=0;i<u;++i)r[i].r+=c;if(h=en(r),c)for(i=0;i<u;++i)r[i].r-=c;t.r=h+c}}}function F(n){return function(e){var t=e.parent;e.r*=n,t&&(e.x=t.x+n*e.x,e.y=t.y+n*e.y)}}function tn(n){n.x0=Math.round(n.x0),n.y0=Math.round(n.y0),n.x1=Math.round(n.x1),n.y1=Math.round(n.y1)}function B(n,e,t,r,i){for(var u=n.children,c,h=-1,l=u.length,f=n.value&&(r-e)/n.value;++h<l;)c=u[h],c.y0=t,c.y1=i,c.x0=e,c.x1=e+=c.value*f}function Hn(){var n=1,e=1,t=0,r=!1;function i(c){var h=c.height+1;return c.x0=c.y0=t,c.x1=n,c.y1=e/h,c.eachBefore(u(e,h)),r&&c.eachBefore(tn),c}function u(c,h){return function(l){l.children&&B(l,l.x0,c*(l.depth+1)/h,l.x1,c*(l.depth+2)/h);var f=l.x0,s=l.y0,o=l.x1-t,a=l.y1-t;o<f&&(f=o=(f+o)/2),a<s&&(s=a=(s+a)/2),l.x0=f,l.y0=s,l.x1=o,l.y1=a}}return i.round=function(c){return arguments.length?(r=!!c,i):r},i.size=function(c){return arguments.length?(n=+c[0],e=+c[1],i):[n,e]},i.padding=function(c){return arguments.length?(t=+c,i):t},i}var Kn={depth:-1},G={};function Pn(n){return n.id}function Xn(n){return n.parentId}function Yn(){var n=Pn,e=Xn;function t(r){var i=Array.from(r),u=i.length,c,h,l,f,s,o,a,d=new Map;for(h=0;h<u;++h)c=i[h],s=i[h]=new I(c),(o=n(c,h,r))!=null&&(o+="")&&(a=s.id=o,d.set(a,d.has(a)?G:s)),(o=e(c,h,r))!=null&&(o+="")&&(s.parent=o);for(h=0;h<u;++h)if(s=i[h],o=s.parent){if(f=d.get(o),!f)throw new Error("missing: "+o);if(f===G)throw new Error("ambiguous: "+o);f.children?f.children.push(s):f.children=[s],s.parent=f}else{if(l)throw new Error("multiple roots");l=s}if(!l)throw new Error("no root");if(l.parent=Kn,l.eachBefore(function(p){p.depth=p.parent.depth+1,--u}).eachBefore(J),l.parent=null,u>0)throw new Error("cycle");return l}return t.id=function(r){return arguments.length?(n=O(r),t):n},t.parentId=function(r){return arguments.length?(e=O(r),t):e},t}function Zn(n,e){return n.parent===e.parent?1:2}function W(n){var e=n.children;return e?e[0]:n.t}function $(n){var e=n.children;return e?e[e.length-1]:n.t}function Fn(n,e,t){var r=t/(e.i-n.i);e.c-=r,e.s+=t,n.c+=r,e.z+=t,e.m+=t}function Gn(n){for(var e=0,t=0,r=n.children,i=r.length,u;--i>=0;)u=r[i],u.z+=e,u.m+=e,e+=u.s+(t+=u.c)}function Jn(n,e,t){return n.a.parent===e.parent?n.a:t}function C(n,e){this._=n,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}C.prototype=Object.create(I.prototype);function Qn(n){for(var e=new C(n,0),t,r=[e],i,u,c,h;t=r.pop();)if(u=t._.children)for(t.children=new Array(h=u.length),c=h-1;c>=0;--c)r.push(i=t.children[c]=new C(u[c],c)),i.parent=t;return(e.parent=new C(null,0)).children=[e],e}function Un(){var n=Zn,e=1,t=1,r=null;function i(f){var s=Qn(f);if(s.eachAfter(u),s.parent.m=-s.z,s.eachBefore(c),r)f.eachBefore(l);else{var o=f,a=f,d=f;f.eachBefore(function(m){m.x<o.x&&(o=m),m.x>a.x&&(a=m),m.depth>d.depth&&(d=m)});var p=o===a?1:n(o,a)/2,g=p-o.x,y=e/(a.x+p+g),x=t/(d.depth||1);f.eachBefore(function(m){m.x=(m.x+g)*y,m.y=m.depth*x})}return f}function u(f){var s=f.children,o=f.parent.children,a=f.i?o[f.i-1]:null;if(s){Gn(f);var d=(s[0].z+s[s.length-1].z)/2;a?(f.z=a.z+n(f._,a._),f.m=f.z-d):f.z=d}else a&&(f.z=a.z+n(f._,a._));f.parent.A=h(f,a,f.parent.A||o[0])}function c(f){f._.x=f.z+f.parent.m,f.m+=f.parent.m}function h(f,s,o){if(s){for(var a=f,d=f,p=s,g=a.parent.children[0],y=a.m,x=d.m,m=p.m,z=g.m,_;p=$(p),a=W(a),p&&a;)g=W(g),d=$(d),d.a=f,_=p.z+m-a.z-y+n(p._,a._),_>0&&(Fn(Jn(p,f,o),f,_),y+=_,x+=_),m+=p.m,y+=a.m,z+=g.m,x+=d.m;p&&!$(d)&&(d.t=p,d.m+=m-x),a&&!W(g)&&(g.t=a,g.m+=y-z,o=f)}return o}function l(f){f.x*=e,f.y=f.depth*t}return i.separation=function(f){return arguments.length?(n=f,i):n},i.size=function(f){return arguments.length?(r=!1,e=+f[0],t=+f[1],i):r?null:[e,t]},i.nodeSize=function(f){return arguments.length?(r=!0,e=+f[0],t=+f[1],i):r?[e,t]:null},i}function b(n,e,t,r,i){for(var u=n.children,c,h=-1,l=u.length,f=n.value&&(i-t)/n.value;++h<l;)c=u[h],c.x0=e,c.x1=r,c.y0=t,c.y1=t+=c.value*f}var rn=(1+Math.sqrt(5))/2;function un(n,e,t,r,i,u){for(var c=[],h=e.children,l,f,s=0,o=0,a=h.length,d,p,g=e.value,y,x,m,z,_,v,w;s<a;){d=i-t,p=u-r;do y=h[o++].value;while(!y&&o<a);for(x=m=y,v=Math.max(p/d,d/p)/(g*n),w=y*y*v,_=Math.max(m/w,w/x);o<a;++o){if(y+=f=h[o].value,f<x&&(x=f),f>m&&(m=f),w=y*y*v,z=Math.max(m/w,w/x),z>_){y-=f;break}_=z}c.push(l={value:y,dice:d<p,children:h.slice(s,o)}),l.dice?B(l,t,r,i,g?r+=p*y/g:u):b(l,t,r,g?t+=d*y/g:i,u),g-=y,s=o}return c}const an=function n(e){function t(r,i,u,c,h){un(e,r,i,u,c,h)}return t.ratio=function(r){return n((r=+r)>1?r:1)},t}(rn);function ne(){var n=an,e=!1,t=1,r=1,i=[0],u=S,c=S,h=S,l=S,f=S;function s(a){return a.x0=a.y0=0,a.x1=t,a.y1=r,a.eachBefore(o),i=[0],e&&a.eachBefore(tn),a}function o(a){var d=i[a.depth],p=a.x0+d,g=a.y0+d,y=a.x1-d,x=a.y1-d;y<p&&(p=y=(p+y)/2),x<g&&(g=x=(g+x)/2),a.x0=p,a.y0=g,a.x1=y,a.y1=x,a.children&&(d=i[a.depth+1]=u(a)/2,p+=f(a)-d,g+=c(a)-d,y-=h(a)-d,x-=l(a)-d,y<p&&(p=y=(p+y)/2),x<g&&(g=x=(g+x)/2),n(a,p,g,y,x))}return s.round=function(a){return arguments.length?(e=!!a,s):e},s.size=function(a){return arguments.length?(t=+a[0],r=+a[1],s):[t,r]},s.tile=function(a){return arguments.length?(n=O(a),s):n},s.padding=function(a){return arguments.length?s.paddingInner(a).paddingOuter(a):s.paddingInner()},s.paddingInner=function(a){return arguments.length?(u=typeof a=="function"?a:N(+a),s):u},s.paddingOuter=function(a){return arguments.length?s.paddingTop(a).paddingRight(a).paddingBottom(a).paddingLeft(a):s.paddingTop()},s.paddingTop=function(a){return arguments.length?(c=typeof a=="function"?a:N(+a),s):c},s.paddingRight=function(a){return arguments.length?(h=typeof a=="function"?a:N(+a),s):h},s.paddingBottom=function(a){return arguments.length?(l=typeof a=="function"?a:N(+a),s):l},s.paddingLeft=function(a){return arguments.length?(f=typeof a=="function"?a:N(+a),s):f},s}function ee(n,e,t,r,i){var u=n.children,c,h=u.length,l,f=new Array(h+1);for(f[0]=l=c=0;c<h;++c)f[c+1]=l+=u[c].value;s(0,h,n.value,e,t,r,i);function s(o,a,d,p,g,y,x){if(o>=a-1){var m=u[o];m.x0=p,m.y0=g,m.x1=y,m.y1=x;return}for(var z=f[o],_=d/2+z,v=o+1,w=a-1;v<w;){var k=v+w>>>1;f[k]<_?v=k+1:w=k}_-f[v-1]<f[v]-_&&o+1<v&&--v;var A=f[v]-z,M=d-A;if(y-p>x-g){var R=d?(p*M+y*A)/d:y;s(o,v,A,p,g,R,x),s(v,a,M,R,g,y,x)}else{var q=d?(g*M+x*A)/d:x;s(o,v,A,p,g,y,q),s(v,a,M,p,q,y,x)}}}function te(n,e,t,r,i){(n.depth&1?b:B)(n,e,t,r,i)}const re=function n(e){function t(r,i,u,c,h){if((l=r._squarify)&&l.ratio===e)for(var l,f,s,o,a=-1,d,p=l.length,g=r.value;++a<p;){for(f=l[a],s=f.children,o=f.value=0,d=s.length;o<d;++o)f.value+=s[o].value;f.dice?B(f,i,u,c,g?u+=(h-u)*f.value/g:h):b(f,i,u,g?i+=(c-i)*f.value/g:c,h),g-=f.value}else r._squarify=l=un(e,r,i,u,c,h),l.ratio=e}return t.ratio=function(r){return n((r=+r)>1?r:1)},t}(rn),ie=Object.freeze(Object.defineProperty({__proto__:null,cluster:pn,hierarchy:H,pack:$n,packSiblings:Dn,packEnclose:Q,partition:Hn,stratify:Yn,tree:Un,treemap:ne,treemapBinary:ee,treemapDice:B,treemapSlice:b,treemapSliceDice:te,treemapSquarify:an,treemapResquarify:re},Symbol.toStringTag,{value:"Module"}));export{$n as a,ie as d,H as h,ne as i,Hn as p};
