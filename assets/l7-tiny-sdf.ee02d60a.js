var M={exports:{}};M.exports=x;M.exports.default=x;var d=1e20;function x(h,n,r,o,f,a){this.fontSize=h||24,this.buffer=n===void 0?3:n,this.cutoff=o||.25,this.fontFamily=f||"sans-serif",this.fontWeight=a||"normal",this.radius=r||8;var i=this.size=this.fontSize+this.buffer*2,t=i+this.buffer*2,e=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;e?this.canvas=my.createOffscreenCanvas(i,i,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=i),this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(t*t),this.gridInner=new Float64Array(t*t),this.f=new Float64Array(t),this.z=new Float64Array(t+1),this.v=new Uint16Array(t),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,e?this.middle=Math.round(i/2*1):this.middle=Math.round(i/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function B(h,n,r,o,f,a,i){a.fill(d,0,n*r),i.fill(0,0,n*r);for(var t=(n-o)/2,e=0;e<f;e++)for(var c=0;c<o;c++){var s=(e+t)*n+c+t,l=h.data[4*(e*o+c)+3]/255;if(l===1)a[s]=0,i[s]=d;else if(l===0)a[s]=d,i[s]=0;else{var u=Math.max(0,.5-l),v=Math.max(0,l-.5);a[s]=u*u,i[s]=v*v}}}function y(h,n,r,o,f,a,i){for(var t=0;t<n*r;t++){var e=Math.sqrt(o[t])-Math.sqrt(f[t]);h[t]=Math.round(255-255*(e/a+i))}}x.prototype._draw=function(h,n){var r=this.ctx.measureText(h),o=r.width,f=2*this.buffer,a,i,t,e,c,s,l,u;n&&this.useMetrics?(c=Math.floor(r.actualBoundingBoxAscent),u=this.buffer+Math.ceil(r.actualBoundingBoxAscent),s=this.buffer,l=this.buffer,i=Math.min(this.size,Math.ceil(r.actualBoundingBoxRight-r.actualBoundingBoxLeft)),e=Math.min(this.size-s,Math.ceil(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)),a=i+f,t=e+f,this.ctx.textBaseline="alphabetic"):(a=i=this.size,t=e=this.size,c=19*this.fontSize/24,s=l=0,u=this.middle,this.ctx.textBaseline="middle");var v;i&&e&&(this.ctx.clearRect(l,s,i,e),this.ctx.fillText(h,this.buffer,u),v=this.ctx.getImageData(l,s,i,e));var m=new Uint8ClampedArray(a*t);return B(v,a,t,i,e,this.gridOuter,this.gridInner),g(this.gridOuter,a,t,this.f,this.v,this.z),g(this.gridInner,a,t,this.f,this.v,this.z),y(m,a,t,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:m,metrics:{width:i,height:e,sdfWidth:a,sdfHeight:t,top:c,left:0,advance:o}}};x.prototype.draw=function(h){return this._draw(h,!1).data};x.prototype.drawWithMetrics=function(h){return this._draw(h,!0)};function g(h,n,r,o,f,a){for(var i=0;i<n;i++)p(h,i,n,r,o,f,a);for(var t=0;t<r;t++)p(h,t*n,1,n,o,f,a)}function p(h,n,r,o,f,a,i){var t,e,c,s;for(a[0]=0,i[0]=-d,i[1]=d,t=0;t<o;t++)f[t]=h[n+t*r];for(t=1,e=0,c=0;t<o;t++){do s=a[e],c=(f[t]-f[s]+t*t-s*s)/(t-s)/2;while(c<=i[e]&&--e>-1);e++,a[e]=t,i[e]=c,i[e+1]=d}for(t=0,e=0;t<o;t++){for(;i[e+1]<t;)e++;s=a[e],h[n+t*r]=f[s]+(t-s)*(t-s)}}export{M as l};
